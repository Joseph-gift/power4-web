<!DOCTYPE html>
<html lang="fr">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<link rel="stylesheet" href="/static/play.css" />
		<title>Pussance 4</title>
		<meta name="color-scheme" content="dark" />
		<style>
			/* small reset so anchor looks like button */
			a.back-button {
				text-decoration: none;
			}
		</style>
	</head>
	<body>
		<!-- GAME -->
		<div class="game-container">
			<div class="game-header">
				<div class="game-top">
					<div class="game-title">
						<svg
							class="sparkle"
							width="24"
							height="24"
							viewBox="0 0 24 24"
							fill="none"
							stroke="#fbbf24"
							stroke-width="2">
							<path d="M12 2L15 9L22 12L15 15L12 22L9 15L2 12L9 9L12 2Z" />
						</svg>
						<h2>Puissance 4</h2>
					</div>
					<a class="back-button" href="/">
						<svg
							width="16"
							height="16"
							viewBox="0 0 24 24"
							fill="none"
							stroke="currentColor"
							stroke-width="2">
							<path d="M3 12h18M3 12l6-6M3 12l6 6" />
						</svg>
						üè† Retour
					</a>
				</div>

				<div class="players-status">
					<div class="player-card red {{if eq .Turn 1}}active{{end}}">
						<div class="player-avatar red"></div>
						<div class="player-name">{{.Player1}}</div>
					</div>
					<div class="player-card yellow {{if eq .Turn 2}}active{{end}}">
						<div class="player-avatar yellow"></div>
						<div class="player-name">{{.Player2}}</div>
					</div>
				</div>
				{{template "result-banner" .}}
			</div>

			<div
				class="board-container"
				style="--cols: {{len (index .Grill 0)}}; --rows: {{len .Grill}}">
				{{if .Finished}}
				<div
					class="column-indicators disabled"
					style="--cols: {{len (index .Grill 0)}}">
					{{range $i, $_ := index .Grill 0}}
					<button type="button" class="column-button" disabled></button>
					{{end}}
				</div>
				{{else}}
				<form
					class="column-indicators"
					action="/move"
					method="post"
					style="--cols: {{len (index .Grill 0)}}">
					{{range $i, $_ := index .Grill 0}}
					<button
						type="submit"
						name="col"
						value="{{$i}}"
						class="column-button"></button>
					{{end}}
				</form>
				{{end}}

				<div class="game-board">{{template "board" .}}</div>
				{{if .Finished}}
				<form action="/rematch" method="post" style="margin-top: 16px">
					<button class="new-game-button" type="submit">
						<svg
							width="20"
							height="20"
							viewBox="0 0 24 24"
							fill="none"
							stroke="currentColor"
							stroke-width="2">
							<path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8" />
							<path d="M3 3v5h5" />
						</svg>
						Nouvelle partie
					</button>
				</form>
				{{end}}
			</div>
		</div>
	</body>
</html>
